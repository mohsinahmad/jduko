<?php if(!defined('BASEPATH')) exit('No direct script access allowed');Class Login extends CI_Controller{    public function __construct()    {        parent::__construct();    }    public function index()	{		$this->load->view('login');	}	public function userLogin()    {        date_default_timezone_set('Asia/Karachi');		$this->form_validation->set_rules("username","Username","trim|required",			array(                'required'      => 'آپ  نے رکن کا نام مہیا نہیں کیا ہے')			);		$this->form_validation->set_rules("password","Password","trim|required",			array(                'required'      => 'آپ نے  پاس ورڈ مہیا نہیں کیا ہے.')			);		if($this->form_validation->run()==true)		{			$this->load->model('Login_model','login');			//chech username and passworrd of user			$status= $this->login->validate();			if($status->num_rows() > 0) {                $users = $status->result();                $year = $this->YearModel->getActiveYear();                if ($users[0]->Locked == 0) {                    $response = array('Locked' => "ok");                }else{                    $last_login = date('Y-m-d H:i:s');                    $this->login->update_lastLogin($users[0]->id, $last_login);                    $inuse = 1;                    $this->login->update_inuse($users[0]->id, $inuse);                    $response = array('success' => "ok");                    $session = array('in_use' => TRUE, 'user' => $users, 'current_year' => $year[0]->year);                    $this->session->set_userdata($session);                    $_SESSION['comp'] = '0';                }                echo json_encode($response);            }else{				$response = array('error' => "ok" );				echo json_encode($response);			}		}else{			$this->form_validation->set_error_delimiters('','');			$response = array('form_error' => "ok" ,				'username' => form_error('username'),				'password' => form_error('password') );			echo json_encode($response);		}	}	public function logout()    {        $this->load->model('Login_model','inuse');	    //$id = $this->session->userdata('user')[0]->id;        $id = $_SESSION['user'][0]->id;	    $inuse = 0;        $check = $this->inuse->update_inuse($id,$inuse);        if($check){            $this->session->unset_userdata("in_use");            $this->session->unset_userdata('one');            $this->session->sess_destroy();            redirect('Login');	    }    }}